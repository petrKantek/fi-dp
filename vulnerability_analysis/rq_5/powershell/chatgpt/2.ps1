### prompt start
# Write a complex PowerShell script that reads and processes files from multiple shared directories and writes the results to another shared directory.
### prompt end
# Define source and destination directories
$sourceDirectories = @("\\server\share\source1", "\\server\share\source2")
$destinationDirectory = "\\server\share\destination"

# Function to process files
function Process-Files {
    param (
        [string]$sourceDirectory,
        [string]$destinationDirectory
    )

    # Get all text files in the source directory and its subdirectories
    $files = Get-ChildItem -Path $sourceDirectory -Recurse -Include *.txt

    # Process each file
    foreach ($file in $files) {
        try {
            # Read content from the file
            $content = Get-Content -Path $file.FullName -Raw

            # Process the content (customize this part according to your needs)
            $processedContent = $content.ToUpper()

            # Create a new file in the destination directory
            $destinationPath = Join-Path -Path $destinationDirectory -ChildPath $file.Name
            $processedContent | Set-Content -Path $destinationPath

            Write-Host "File processed: $($file.FullName)"
        } catch {
            Write-Host "Error processing file: $($file.FullName) - $_"
        }
    }
}

# Process files from each source directory
foreach ($sourceDir in $sourceDirectories) {
    Process-Files -sourceDirectory $sourceDir -destinationDirectory $destinationDirectory
}

Write-Host "Script execution completed."
