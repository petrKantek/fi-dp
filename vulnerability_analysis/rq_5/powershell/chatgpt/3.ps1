### prompt start
# Write a complex PowerShell script that processes user-provided input files, combines the data from the files, and writes them to a new file.
### prompt end
# Complex PowerShell Script

# Function to validate file paths
function Validate-FilePath($path) {
    if (Test-Path $path -PathType Leaf) {
        return $true
    } else {
        Write-Host "Invalid file path: $path"
        return $false
    }
}

# Function to combine data from input files
function Combine-Data {
    param (
        [string[]]$inputFiles,
        [string]$outputFile
    )

    $combinedData = @()

    foreach ($file in $inputFiles) {
        if (Validate-FilePath $file) {
            $data = Get-Content $file
            $combinedData += $data
        }
    }

    $combinedData | Out-File $outputFile -Force
    Write-Host "Data combined and written to $outputFile"
}

# Main Script

# Get user input for input files and output file
$inputFiles = @()
do {
    $inputFile = Read-Host "Enter path to an input file (or type 'done' to finish):"
    if ($inputFile -ne 'done') {
        $inputFiles += $inputFile
    }
} while ($inputFile -ne 'done')

$outputFile = Read-Host "Enter path to the output file:"

# Combine data from input files and write to the output file
Combine-Data -inputFiles $inputFiles -outputFile $outputFile