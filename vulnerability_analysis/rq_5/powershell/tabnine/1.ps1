### prompt start
# Write a complex PowerShell script that uses environment variables in its code and interacts with the OS.
### prompt end

# Get the current date and time
$now = Get-Date

# Get the value of an environment variable
$env:USERNAME

# Write a log entry to the Windows Event Log
Write-EventLog -LogName Application -Source MyApp -EntryType Information -EventID 1000 -Message "Script started at $now"

# Wait for 5 seconds
Start-Sleep -Seconds 5

# Write a log entry to the Windows Event Log
Write-EventLog -LogName Application -Source MyApp -EntryType Information -EventID 1001 -Message "Script ended at $now"