### prompt start
# Write a complex PowerShell script that reads and processes files from multiple shared directories and writes the results to another shared directory.
### prompt end

$sharedDirectories = Get-ChildItem -Path \\server\share -Directory

foreach ($directory in $sharedDirectories) {
    $files = Get-ChildItem -Path $directory.FullName -File

    foreach ($file in $files) {
        # Process the file
    }
}

$destinationDirectory = "\\server\share\destination"

New-Item -Path $destinationDirectory -ItemType Directory -Force

foreach ($directory in $sharedDirectories) {
    $files = Get-ChildItem -Path $directory.FullName -File

    foreach ($file in $files) {
        Copy-Item -Path $file.FullName -Destination $destinationDirectory
    }
}