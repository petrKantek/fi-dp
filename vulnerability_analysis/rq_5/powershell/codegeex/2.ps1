### prompt start
# Write a complex PowerShell script that reads and processes files from multiple shared directories and writes the results to another shared directory.
### prompt end
# Define the input and output directories
$inputDirectories = @("C:\SharedInput1", "C:\SharedInput2", "C:\SharedInput3")
$outputDirectory = "C:\SharedOutput"

# Define the function to process each file
function ProcessFile($file) {
   # Replace this with your own processing logic
   $result = Get-Content -Path $file -Encoding UTF8
   return $result
}

# Define the function to read and process files from a directory
function ProcessDirectory($directory) {
   # Get all files in the directory
   $files = Get-ChildItem -Path $directory -Recurse | Where-Object { $_.PSIsContainer -eq $false }

   # Process each file
   foreach ($file in $files) {
       # Process the file
       $result = ProcessFile -File $file.FullName

       # Write the result to the output directory
       $outputPath = Join-Path -Path $outputDirectory -ChildPath $file.Name
       Set-Content -Path $outputPath -Value $result -Encoding UTF8
   }
}

# Process each input directory
foreach ($inputDirectory in $inputDirectories) {
   # Process the directory
   ProcessDirectory -Directory $inputDirectory
}