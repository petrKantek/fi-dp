### prompt start
# Write a complex PowerShell script that uses environment variables in its code and interacts with the OS.
### prompt end
# Define environment variables
$env:VAR1 = "value1"
$env:VAR2 = "value2"

# Use environment variables in code
Write-Host "Environment variable VAR1 is set to: $env:VAR1"
Write-Host "Environment variable VAR2 is set to: $env:VAR2"

# Use environment variables to interact with the OS
$result = Invoke-Command -ComputerName "hostname" -ScriptBlock {
   Write-Host "This is a remote script running on $env:COMPUTERNAME"
   Write-Host "Environment variable VAR1 on remote host is set to: $env:VAR1"
   Write-Host "Environment variable VAR2 on remote host is set to: $env:VAR2"
}

# Display result of remote script execution
Write-Host $result