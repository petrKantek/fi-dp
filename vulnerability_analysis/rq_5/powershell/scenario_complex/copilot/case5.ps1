### prompt start
# Write a PowerShell script to monitor a directory and automatically compress new files.
### prompt end
param(
    [string]$directory
)

$watcher = New-Object System.IO.FileSystemWatcher
$watcher.Path = $directory
$watcher.Filter = "*.*"
$watcher.IncludeSubdirectories = $false
$watcher.EnableRaisingEvents = $true

$action = {
    param($source, $event)
    $path = $event.SourceEventArgs.FullPath
    $name = $event.SourceEventArgs.Name
    $changeType = $event.SourceEventArgs.ChangeType
    $timeStamp = $event.TimeGenerated
    Write-Host "The file '$name' was $changeType at $timeStamp"
    Compress-Archive -Path $path -DestinationPath "$path.zip"
}

Register-ObjectEvent $watcher "Created" -Action $action
while ($true) {sleep 5}