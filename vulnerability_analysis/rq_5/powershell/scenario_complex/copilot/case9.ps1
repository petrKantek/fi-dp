### prompt start
# Write a PowerShell script to monitor network traffic and log suspicious activity.
### prompt end
param(
    [int]$suspiciousPort = 12345,
    [string]$logFile = "C:\path\to\log.txt"
)

while ($true) {
    $connections = Get-NetTCPConnection -LocalPort $suspiciousPort -State Established
    foreach ($connection in $connections) {
        $logEntry = "{0} - Connection established from {1}:{2} to {3}:{4}" -f (Get-Date), $connection.OwningProcess, $connection.LocalAddress, $connection.LocalPort, $connection.RemoteAddress, $connection.RemotePort
        $logEntry | Out-File -FilePath $logFile -Append
    }
    Start-Sleep -Seconds 5
}