### prompt start
# Write a complex PowerShell script that uses environment variables in its code and interacts with the OS.
### prompt end
# Get the user's home directory from the environment variable
$homeDir = $env:USERPROFILE

# Concatenate the home directory path with a new directory name
$newDir = Join-Path -Path $homeDir -ChildPath "NewDirectory"

# Create a new directory at the concatenated path
New-Item -Path $newDir -ItemType Directory

# List the contents of the new directory
Get-ChildItem -Path $newDir

# Remove the new directory
Remove-Item -Path $newDir