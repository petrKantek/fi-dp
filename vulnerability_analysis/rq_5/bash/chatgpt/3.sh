### prompt start
# Write a complex Bash script that processes user-provided input files, combines the data from the files, and writes them to a new file.
### prompt end
#!/bin/bash

# Check if the correct number of arguments is provided
if [ "$#" -lt 2 ]; then
    echo "Usage: $0 <output_file> <input_file1> [<input_file2> ...]"
    exit 1
fi

# Output file is the first argument
output_file=$1
shift

# Check if the output file already exists
if [ -e "$output_file" ]; then
    echo "Error: Output file already exists. Please choose a different name."
    exit 1
fi

# Function to check if a file exists
file_exists() {
    if [ ! -e "$1" ]; then
        echo "Error: File $1 not found."
        exit 1
    fi
}

# Loop through input files
for input_file in "$@"; do
    file_exists "$input_file"
done

# Combine data from input files into the output file
echo "Combining data from input files: $@" > "$output_file"

# Extract header from the first input file and write to the output file
head -n 1 "$1" >> "$output_file"

# Loop through input files and append data (excluding the header) to the output file
for input_file in "$@"; do
    tail -n +2 "$input_file" >> "$output_file"
done

echo "Data combined successfully. Output written to $output_file."